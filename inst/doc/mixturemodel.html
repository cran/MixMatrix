<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Geoffrey Thompson" />

<meta name="date" content="2021-11-15" />

<title>Matrix Variate Mixture Models with the t distribution</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Matrix Variate Mixture Models with the t distribution</h1>
<h4 class="author">Geoffrey Thompson</h4>
<h4 class="date">2021-11-15</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="kw">library</span>(MixMatrix)</span></code></pre></div>
<div id="matrix-variate-mixture-modeling-with-the-t-distribution" class="section level2">
<h2>Matrix Variate Mixture Modeling with the <span class="math inline">\(t\)</span> Distribution</h2>
<p>The matrix variate <em>t</em> distribution was introduced in a previous vignette along with an EM algorithm for maximum likelihood fitting of the parameters. This can be extended rather easily to the case of mixture models for model-based clustering.</p>
<p>As in the case of mixture modeling in general <span class="citation">(Fraley and Raftery <a href="#ref-fraley2002model" role="doc-biblioref">2002</a>; McLachlan, Lee, and Rathnayake <a href="#ref-mclachlan2019finite" role="doc-biblioref">2019</a>)</span>, the difference in the EM algorithm is that one is now including estimates of <span class="math inline">\(\pi_{j}\)</span> for <span class="math inline">\(j\)</span> in <span class="math inline">\(1,2, \ldots, g\)</span>, the estimated probabilities of group membership for the <span class="math inline">\(g\)</span> groups in each step and weights <span class="math inline">\(\tau_{ij}\)</span>, weights for each observation <span class="math inline">\(i\)</span> and group <span class="math inline">\(j\)</span>, where <span class="math display">\[\pi_j = \frac{1}{n}\sum_{i = 1}^n \tau_{ij}\]</span> and <span class="math display">\[ \tau_{ij} = \frac{\pi_j f(x_i, \Theta_j)}{\sum_{l=1}^g \pi_l f(x_i, \Theta_l)}\]</span></p>
<p>The case of the matrix variate normal distribution can be seen in <span class="citation">Viroli (<a href="#ref-viroliclass2011" role="doc-biblioref">2011</a>)</span>, while the case of the multivariate <em>t</em> can be seen in <span class="citation">Andrews, McNicholas, and Subedi (<a href="#ref-ANDREWS2011520" role="doc-biblioref">2011</a>)</span>.</p>
<p>The updates on the parameters <span class="math inline">\(\Theta\)</span> are weighted by <span class="math inline">\(\tau_{ij}\)</span> in an Expectation/Conditional Maximization algorithm.</p>
</div>
<div id="usage" class="section level2">
<h2>Usage</h2>
<p>The <code>matrixmixture()</code> function fits unrestricted covariance matrices currently, but future features will implement a <a href="https://cran.r-project.org/package=teigen"><code>teigen</code></a> type of covariance restriction capability for use with the <span class="math inline">\(t\)</span> distribution. It can set means to be constant along rows or columns or both using the <code>row.mean = TRUE</code> and <code>col.mean = TRUE</code> settings.</p>
<p>Currently, this can perform model fitting with unrestricted covariance matrices and fixed degrees of freedom (<code>nu</code>) parameter or for the matrix normal distribution. It does not solve the identifiability problem, that is, that permutations of the labels will yield identical solutions.</p>
<div id="matrixmixture-function" class="section level3">
<h3><code>matrixmixture</code> function</h3>
<p>The function takes data array <code>x</code>, either an argument <code>K</code> for how many groups there are or an initialization of a vector of probabilities <code>prior</code>, an optional initialization of centers and covariance matrices <code>init</code> (if the covariances are left blank, they will be initialized to identity matrices), and optional arguments controlling the other parameters of function, such as number of iterations and normal vs <em>t</em>. If <code>model = &quot;t&quot;</code> is chosen, the degrees of freedom <code>nu</code> must be provided, but in the future it can be estimated.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="kw">library</span>(MixMatrix)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a> <span class="kw">set.seed</span>(<span class="dv">20180221</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a> A &lt;-<span class="st"> </span><span class="kw">rmatrixt</span>(<span class="dv">30</span>,<span class="dt">mean=</span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">4</span>), <span class="dt">df =</span> <span class="dv">10</span>) <span class="co"># 3x4 matrices with mean 0</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a> B &lt;-<span class="st"> </span><span class="kw">rmatrixt</span>(<span class="dv">30</span>,<span class="dt">mean=</span><span class="kw">matrix</span>(<span class="dv">1</span>,<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">4</span>), <span class="dt">df =</span> <span class="dv">10</span>) <span class="co"># 3x4 matrices with mean 2</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a> C &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="kw">c</span>(A,B), <span class="dt">dim=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">60</span>)) <span class="co"># combine into one array</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a> prior &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">5</span>,.<span class="dv">5</span>) <span class="co"># equal probability prior</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a> <span class="co"># create an intialization object, starts at the true parameters</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a> init =<span class="st"> </span><span class="kw">list</span>(<span class="dt">centers =</span> <span class="kw">array</span>(<span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">12</span>),<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">12</span>)), <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>)),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true"></a>              <span class="dt">U =</span> <span class="kw">array</span>(<span class="kw">c</span>(<span class="kw">diag</span>(<span class="dv">3</span>), <span class="kw">diag</span>(<span class="dv">3</span>)), <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>)),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true"></a>              <span class="dt">V =</span> <span class="kw">array</span>(<span class="kw">c</span>(<span class="kw">diag</span>(<span class="dv">4</span>), <span class="kw">diag</span>(<span class="dv">4</span>)), <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>))</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true"></a>             )</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true"></a> <span class="co"># fit model</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true"></a> res&lt;-<span class="kw">matrixmixture</span>(C, <span class="dt">init =</span> init, <span class="dt">prior =</span> prior, <span class="dt">nu =</span> <span class="dv">10</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true"></a>                    <span class="dt">model =</span> <span class="st">&quot;t&quot;</span>, <span class="dt">tolerance =</span> <span class="fl">1e-2</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true"></a> <span class="kw">print</span>(res<span class="op">$</span>centers) <span class="co"># the final centers</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true"></a><span class="co">#&gt; , , 1</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true"></a><span class="co">#&gt;              [,1]        [,2]        [,3]        [,4]</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true"></a><span class="co">#&gt; [1,] -0.005608544  0.01263007  0.03606995  0.02008999</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true"></a><span class="co">#&gt; [2,] -0.036807465 -0.00922546 -0.02606685 -0.03205214</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true"></a><span class="co">#&gt; [3,] -0.068637713 -0.06653189 -0.00752340 -0.04191753</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true"></a><span class="co">#&gt; , , 2</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true"></a><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true"></a><span class="co">#&gt; [1,] 0.9785204 0.9459763 0.9561746 0.9857805</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true"></a><span class="co">#&gt; [2,] 1.0928959 0.9807877 0.8435277 1.0341407</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true"></a><span class="co">#&gt; [3,] 1.1422649 1.0527232 0.9998141 1.0383794</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true"></a> <span class="kw">print</span>(res<span class="op">$</span>pi) <span class="co"># the final mixing proportion</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true"></a><span class="co">#&gt; [1] 0.4999994 0.5000006</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true"></a> <span class="kw">logLik</span>(res)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true"></a><span class="co">#&gt; &#39;log Lik.&#39; -442.517 (df=54)</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true"></a> <span class="kw">AIC</span>(<span class="kw">logLik</span>(res))</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true"></a><span class="co">#&gt; [1] 993.0339</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true"></a> <span class="kw">plot</span>(res) <span class="co"># the log likelihood by iteration</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The default method for determining convergence is based on Aitken acceleration of the log-likelihood. However, it can be set to stop based on changes in the log-likelihood instead.</p>
</div>
<div id="initialization-function" class="section level3">
<h3>Initialization function</h3>
<p>The packages also provides a helper function <code>init_matrixmixture()</code> to provide the <code>init</code> object for you. At present, it can either use the <code>kmeans()</code> function on the vectorization of the input data to provide starting centers or select random points. The <code>...</code> arguments are passed to <code>kmeans()</code> (so <code>nstart</code> of other similar arguments can be set). If a partially formed <code>init</code> object is sent to the initializer, it will complete it. However, it will not validate that, for instance, the covariance matrices are valid. Partial supply of initial centers is also supported - that is, if fewer centers than groups are provided, the remainder will be chosen by whatever method selected.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="kw">init_matrixmixture</span>(C, <span class="dt">prior =</span> <span class="kw">c</span>(.<span class="dv">5</span>,.<span class="dv">5</span>), <span class="dt">centermethod =</span> <span class="st">&#39;kmeans&#39;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a><span class="co">#&gt; $centers</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a><span class="co">#&gt; , , 1</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a><span class="co">#&gt;             [,1]       [,2]        [,3]         [,4]</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a><span class="co">#&gt; [1,]  0.11412574 -0.1191619 -0.04078157  0.127204662</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a><span class="co">#&gt; [2,] -0.09798116  0.1763393 -0.02998913  0.001676302</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true"></a><span class="co">#&gt; [3,]  0.16767860 -0.1738115 -0.20268828 -0.079679047</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true"></a><span class="co">#&gt; , , 2</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true"></a><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true"></a><span class="co">#&gt; [1,] 1.0480976 1.0029779 1.0264273 1.0225414</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true"></a><span class="co">#&gt; [2,] 0.9755583 1.0876427 1.0131553 1.2830619</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true"></a><span class="co">#&gt; [3,] 0.9418708 0.9333342 0.8656007 0.9025196</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true"></a><span class="co">#&gt; $U</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true"></a><span class="co">#&gt; , , 1</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    0    0</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true"></a><span class="co">#&gt; [2,]    0    1    0</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true"></a><span class="co">#&gt; [3,]    0    0    1</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true"></a><span class="co">#&gt; , , 2</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    0    0</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true"></a><span class="co">#&gt; [2,]    0    1    0</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true"></a><span class="co">#&gt; [3,]    0    0    1</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true"></a><span class="co">#&gt; $V</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true"></a><span class="co">#&gt; NULL</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true"></a><span class="kw">init_matrixmixture</span>(C, <span class="dt">K =</span> <span class="dv">2</span>, <span class="dt">centermethod =</span> <span class="st">&#39;random&#39;</span>)</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true"></a><span class="co">#&gt; $centers</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true"></a><span class="co">#&gt; , , 1</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true"></a><span class="co">#&gt;          [,1]      [,2]      [,3]      [,4]</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true"></a><span class="co">#&gt; [1,] 1.678144 1.1288934 1.0701532 0.8945011</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true"></a><span class="co">#&gt; [2,] 1.452156 1.0876125 0.6176221 1.0579284</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true"></a><span class="co">#&gt; [3,] 1.271707 0.8391508 1.0755241 1.3799744</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true"></a><span class="co">#&gt; , , 2</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true"></a><span class="co">#&gt;             [,1]        [,2]       [,3]        [,4]</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true"></a><span class="co">#&gt; [1,] -0.13670235 -0.22542286 -0.1013062  0.08921306</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true"></a><span class="co">#&gt; [2,]  0.02554019  0.07765350 -0.1971374 -0.09639281</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true"></a><span class="co">#&gt; [3,] -0.47626926 -0.03061907  0.1719943 -0.17784713</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true"></a><span class="co">#&gt; $U</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true"></a><span class="co">#&gt; , , 1</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    0    0</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true"></a><span class="co">#&gt; [2,]    0    1    0</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true"></a><span class="co">#&gt; [3,]    0    0    1</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true"></a><span class="co">#&gt; , , 2</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    0    0</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true"></a><span class="co">#&gt; [2,]    0    1    0</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true"></a><span class="co">#&gt; [3,]    0    0    1</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true"></a><span class="co">#&gt; $V</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true"></a><span class="co">#&gt; NULL</span></span></code></pre></div>
</div>
</div>
<div id="session-information" class="section level2">
<h2>Session Information</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="kw">sessionInfo</span>()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span class="co">#&gt; R version 4.0.5 (2021-03-31)</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a><span class="co">#&gt; Platform: x86_64-redhat-linux-gnu (64-bit)</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span class="co">#&gt; Running under: Fedora 34 (MATE-Compiz)</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a><span class="co">#&gt; Matrix products: default</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a><span class="co">#&gt; BLAS/LAPACK: /usr/lib64/libflexiblas.so.3.0</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true"></a><span class="co">#&gt; locale:</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true"></a><span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true"></a><span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=C              </span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true"></a><span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true"></a><span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true"></a><span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true"></a><span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true"></a><span class="co">#&gt; attached base packages:</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true"></a><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true"></a><span class="co">#&gt; other attached packages:</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true"></a><span class="co">#&gt; [1] magrittr_2.0.1  dplyr_1.0.7     ggplot2_3.3.5   MixMatrix_0.2.6</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true"></a><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true"></a><span class="co">#&gt;  [1] Rcpp_1.0.7        highr_0.9         bslib_0.3.0       compiler_4.0.5   </span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true"></a><span class="co">#&gt;  [5] pillar_1.6.4      jquerylib_0.1.4   tools_4.0.5       digest_0.6.28    </span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true"></a><span class="co">#&gt;  [9] jsonlite_1.7.2    evaluate_0.14     lifecycle_1.0.1   tibble_3.1.5     </span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true"></a><span class="co">#&gt; [13] gtable_0.3.0      pkgconfig_2.0.3   rlang_0.4.12      DBI_1.1.1        </span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true"></a><span class="co">#&gt; [17] yaml_2.2.1        xfun_0.26         fastmap_1.1.0     withr_2.4.2      </span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true"></a><span class="co">#&gt; [21] stringr_1.4.0     knitr_1.34        generics_0.1.0    sass_0.4.0       </span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true"></a><span class="co">#&gt; [25] vctrs_0.3.8       tidyselect_1.1.1  grid_4.0.5        glue_1.4.2       </span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true"></a><span class="co">#&gt; [29] R6_2.5.1          fansi_0.5.0       rmarkdown_2.11    farver_2.1.0     </span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true"></a><span class="co">#&gt; [33] purrr_0.3.4       scales_1.1.1      htmltools_0.5.2   ellipsis_0.3.2   </span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true"></a><span class="co">#&gt; [37] assertthat_0.2.1  CholWishart_1.1.0 colorspace_2.0-2  labeling_0.4.2   </span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true"></a><span class="co">#&gt; [41] utf8_1.2.2        stringi_1.7.4     munsell_0.5.0     crayon_1.4.1</span></span></code></pre></div>
</div>
<div id="all-the-code-for-easy-copying" class="section level2">
<h2>All the code for easy copying</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a>  <span class="dt">collapse =</span> <span class="ot">TRUE</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a>  <span class="dt">comment =</span> <span class="st">&quot;#&gt;&quot;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a><span class="kw">library</span>(MixMatrix)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a> <span class="kw">set.seed</span>(<span class="dv">20180221</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a> A &lt;-<span class="st"> </span><span class="kw">rmatrixt</span>(<span class="dv">30</span>,<span class="dt">mean=</span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">4</span>), <span class="dt">df =</span> <span class="dv">10</span>) <span class="co"># 3x4 matrices with mean 0</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true"></a> B &lt;-<span class="st"> </span><span class="kw">rmatrixt</span>(<span class="dv">30</span>,<span class="dt">mean=</span><span class="kw">matrix</span>(<span class="dv">1</span>,<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">4</span>), <span class="dt">df =</span> <span class="dv">10</span>) <span class="co"># 3x4 matrices with mean 2</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true"></a> C &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="kw">c</span>(A,B), <span class="dt">dim=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">60</span>)) <span class="co"># combine into one array</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true"></a> prior &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">5</span>,.<span class="dv">5</span>) <span class="co"># equal probability prior</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true"></a> <span class="co"># create an intialization object, starts at the true parameters</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true"></a> init =<span class="st"> </span><span class="kw">list</span>(<span class="dt">centers =</span> <span class="kw">array</span>(<span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">12</span>),<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">12</span>)), <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>)),</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true"></a>              <span class="dt">U =</span> <span class="kw">array</span>(<span class="kw">c</span>(<span class="kw">diag</span>(<span class="dv">3</span>), <span class="kw">diag</span>(<span class="dv">3</span>)), <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>)),</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true"></a>              <span class="dt">V =</span> <span class="kw">array</span>(<span class="kw">c</span>(<span class="kw">diag</span>(<span class="dv">4</span>), <span class="kw">diag</span>(<span class="dv">4</span>)), <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>))</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true"></a>             )</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true"></a> <span class="co"># fit model</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true"></a> res&lt;-<span class="kw">matrixmixture</span>(C, <span class="dt">init =</span> init, <span class="dt">prior =</span> prior, <span class="dt">nu =</span> <span class="dv">10</span>,</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true"></a>                    <span class="dt">model =</span> <span class="st">&quot;t&quot;</span>, <span class="dt">tolerance =</span> <span class="fl">1e-2</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true"></a> <span class="kw">print</span>(res<span class="op">$</span>centers) <span class="co"># the final centers</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true"></a> <span class="kw">print</span>(res<span class="op">$</span>pi) <span class="co"># the final mixing proportion</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true"></a> <span class="kw">logLik</span>(res)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true"></a> <span class="kw">AIC</span>(<span class="kw">logLik</span>(res))</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true"></a> <span class="kw">plot</span>(res) <span class="co"># the log likelihood by iteration</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true"></a></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true"></a><span class="kw">init_matrixmixture</span>(C, <span class="dt">prior =</span> <span class="kw">c</span>(.<span class="dv">5</span>,.<span class="dv">5</span>), <span class="dt">centermethod =</span> <span class="st">&#39;kmeans&#39;</span>)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true"></a><span class="kw">init_matrixmixture</span>(C, <span class="dt">K =</span> <span class="dv">2</span>, <span class="dt">centermethod =</span> <span class="st">&#39;random&#39;</span>)</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true"></a></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true"></a><span class="kw">sessionInfo</span>()</span></code></pre></div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references hanging-indent">
<div id="ref-ANDREWS2011520">
<p>Andrews, Jeffrey L., Paul D. McNicholas, and Sanjeena Subedi. 2011. “Model-Based Classification via Mixtures of Multivariate T-Distributions.” <em>Computational Statistics &amp; Data Analysis</em> 55 (1): 520–29. <a href="https://doi.org/10.1016/j.csda.2010.05.019">https://doi.org/10.1016/j.csda.2010.05.019</a>.</p>
</div>
<div id="ref-fraley2002model">
<p>Fraley, Chris, and Adrian E Raftery. 2002. “Model-Based Clustering, Discriminant Analysis, and Density Estimation.” <em>Journal of the American Statistical Association</em> 97 (458): 611–31. <a href="https://doi.org/10.1198/016214502760047131">https://doi.org/10.1198/016214502760047131</a>.</p>
</div>
<div id="ref-mclachlan2019finite">
<p>McLachlan, Geoffrey J, Sharon X Lee, and Suren I Rathnayake. 2019. “Finite Mixture Models.” <em>Annual Review of Statistics and Its Application</em> 6: 355–78. <a href="https://doi.org/10.1146/annurev-statistics-031017-100325">https://doi.org/10.1146/annurev-statistics-031017-100325</a>.</p>
</div>
<div id="ref-viroliclass2011">
<p>Viroli, Cinzia. 2011. “Finite Mixtures of Matrix Normal Distributions for Classifying Three-Way Data.” <em>Statistics and Computing</em> 21 (4): 511–22. <a href="https://doi.org/10.1007/s11222-010-9188-x">https://doi.org/10.1007/s11222-010-9188-x</a>.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
